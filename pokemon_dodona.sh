### part 1 ###
2,$!sort -t ',' -k5nr -k2f

### part 2 ###
%s#\([1234567890]*,[^,]*,\)\([^,]*\),\([^,]*\)\(.*\)#\1\2;\3\4#g
%s#\([1234567890]]*,[^,]*,\)\([^,]*\);,\(.*\)#\1\2,\3#g
%s@\(#,Name,\)Type 1;Type 2,\(Total,HP,Attack,Weaknesses\)@\1Types,\2@g

### part 3 ###
%s#\([1234567890]\+,[^,]\+,[^,]\+,[1234567890]\+,[56789][1234567890],.*\)#\1,strong#g
%s#\([1234567890]\+,[^,]\+,[^,]\+,[1234567890]\+,[123456789][1234567890][1234567890][1234567890]*,.*\)#\1,strong#g
%s#\([1234567890]\+,[^,]\+,[^,]\+,[1234567890]\+,[1234][1234567890],.*\)#\1,weak#g
%s#\([1234567890]\+,[^,]\+,[^,]\+,[1234567890]\+,[1234567890],.*\)#\1,weak#g
%s@\(#,Name,Types,Total,HP,Attack,Weaknesses\)@\1,Strength@g

### part 4 ###
%s#.*[1234567890]\+,[1234567890]\+,.*Ice.*;\(Rock\|Fire\).*##g
%s#.*[1234567890]\+,[1234567890]\+,.*\(Rock\|Fire\).*;Ice.*##g
g/^$/d

### part 5 ###
:2,$s#^[0-9]*#\=printf(line('.')-1)#